<!DOCTYPE html>
<html lang="es">

<head>
     <meta charset="UTF-8">

     <!--Import Google Icon Font-->
     <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
     <!-- Compiled and minified CSS -->
     <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/css/materialize.min.css">

     <!--Let browser know website is optimized for mobile-->
     <meta name="viewport" content="width=device-width, initial-scale=1.0" />
     <!-- importando mis estilos -->
     <link rel="stylesheet" href="./styles.css">
     <style>
          .fade-enter-active,
          .fade-leave-active {
               transition: opacity .5s;
          }

          .fade-enter,
          .fade-leave-to
          /* .fade-leave-active below version 2.1.8 */

               {
               opacity: 0;
          }
     </style>

</head>

<body>
     <div class="container">
          <div class="row">
               <div class="col s12">
                    <div class="section">
                         <h3>Formulario Reactivo</h3>
                    </div>
               </div>
               <div class="col-s12">
                    <div class="section">
                         <div class="row">
                              <form class="col s12" id="frmApp" @submit.prevent="sendFrm">
                                   <!-- input text -->
                                   <div class="row">
                                        <div class="input-field col s6">
                                             <input name="name" title="Recuerde, No admite numeros ni caracteres especiales" placeholder="Placeholder" id="first_name"
                                                  type="text" class="validate" pattern="^[A-Za-zÑñÁáÉéÍíÓóÚúÜü\s]+$" v-model="frmData.name"
                                                  @keyup="validateData" required>
                                             <label for="first_name">First Name</label>
                                             <transition name="fade">
                                                  <span v-show="message.name" v-text="message.name" class="red-text ContactForm-message "></span>
                                             </transition>
                                        </div>
                                        <div class="input-field col s6">
                                             <input title="Recuerde, No admite numeros ni caracteres especiales" name="lastName" id="last_name" type="text" class="validate"
                                                  pattern="^[A-Za-zÑñÁáÉéÍíÓóÚúÜü\s]+$" v-model="frmData.lastName" @keyup="validateData"
                                                  required>
                                             <label for="last_name">Last Name</label>
                                             <transition name="fade">
                                                  <span v-show="message.lastName" v-text="message.lastName" class="red-text ContactForm-message "></span>
                                             </transition>
                                        </div>
                                   </div>
                                   <!-- input password -->
                                   <div class="row">
                                        <div class="input-field col s12">
                                             <input name="pass" id="password" type="password" v-model="frmData.pass" @keyup="validatePass" required>
                                             <label for="password">Password</label>
                                             <transition name="fade">
                                                  <span v-show="message.pass" v-text="message.pass" class="red-text ContactForm-message "></span>
                                             </transition>
                                        </div>
                                   </div>
                                   <!-- input numero -->
                                   <div class="row">
                                        <div class="input-field col s12">
                                             <input title="Ingrese un numero con el formato +5735435433345" name="frmNumber" id="tel" type="number" pattern="^[0-9]+$"
                                                  v-model="frmData.frmNumber" @keyup="validateData">
                                             <label for="password">Number Phone</label>
                                             <transition name="fade">
                                                  <span v-show="message.frmNumber" v-text="message.frmNumber" class="red-text ContactForm-message "></span>
                                             </transition>
                                        </div>
                                   </div>
                                   <!-- email -->
                                   <div class="row">
                                        <div class="input-field col s12">
                                             <input name="frmEmail" title="Ingrese un correo con el formato minombre@miempresa.com" id="email" type="email" class="validate"
                                                  pattern="^[a-z0-9]+(\.[_a-z0-9]+)*@[a-z0-9-]+(\.[a-z0-9-]+)*(\.[a-z]{2,15})$"
                                                  v-model="frmData.frmEmail" @keyup="validateData">
                                             <label for="email">Email</label>
                                             <transition name="fade">
                                                  <span v-show="message.frmEmail" v-text="message.frmEmail" class="red-text ContactForm-message "></span>
                                             </transition>
                                        </div>
                                   </div>
                                   <!-- radio buttons -->
                                   <div class="row">
                                        <div class="input-field col s3">
                                             <p>
                                                  <label>
                                                       <input type="checkbox" class="filled-in" checked="checked" v-model="frmData.frmCheck" />
                                                       <span>Acepto Terminos</span>
                                                  </label>
                                             </p>
                                        </div>
                                        <div class="input-field col s3">
                                             <p>
                                                  <label>
                                                       <input type="radio" v-model="frmData.frmRadio" value="One" />
                                                       <span>M</span>
                                                  </label>
                                             </p>
                                        </div>
                                        <div class="input-field col s3">
                                             <p>
                                                  <label>
                                                       <input type="radio" v-model="frmData.frmRadio" value="Two" />
                                                       <span>F</span>
                                                  </label>
                                             </p>
                                        </div>
                                        <div class="input-field col s3">
                                             <div class="switch">
                                                  <label>
                                                       Off
                                                       <input type="checkbox" v-model="frmData.frmSwitch">
                                                       <span class="lever"></span>
                                                       On
                                                  </label>
                                             </div>
                                        </div>
                                   </div>
                                   <!--range input -->
                                   <div class="row">
                                        <div class="input-field col s12">
                                             <p class="range-field">
                                                  <input type="range" id="test5" min="0" max="10" v-model="frmData.frmRange" />
                                             </p>
                                        </div>
                                   </div>
                                   <!-- select  -->
                                   <div class="row">
                                        <div class="input-field col s12">
                                             <select v-model="frmData.frmSelect">
                                                  <option value="" disabled selected>Escoja una Opción</option>
                                                  <option value="1">Option 1</option>
                                                  <option value="2">Option 2</option>
                                                  <option value="3">Option 3</option>
                                             </select>
                                             <label>Selecciones un Pais</label>
                                        </div>
                                   </div>
                                   <div class="row">
                                        <div class="input-field col s1">
                                             <button class="btn waves-effect waves-light" type="submit" name="action">Submit
                                                  <i class="material-icons right">send</i>
                                             </button>
                                        </div>
                                   </div>
                                   <!-- <pre>{{$data}}</pre> -->
                              </form>
                         </div>
                    </div>
               </div>
          </div>
     </div>
     <!-- Compiled and minified JavaScript -->
     <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0-rc.2/js/materialize.min.js"></script>
     <!-- inizializando librerias materialize css -->
     <script>
          document.addEventListener('DOMContentLoaded', function () {
               M.AutoInit();
          });
     </script>

     <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>
     <!-- Vuejs development version, includes helpful console warnings -->
     <script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
     <!-- importando axios -->
     <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.18.0/axios.min.js"></script>
     <!-- instanciando vue -->
     <script>
          var app = new Vue({
               el: '#frmApp',
               data: {
                    frmData: {
                         name: '',
                         lastName: '',
                         pass: '',
                         frmNumber: '',
                         frmDate: '',
                         frmEmail: '',
                         frmCheck: '',
                         frmRadio: '',
                         frmRange: '',
                         frmSwitch: '',
                         frmSelect: ''
                    },
                    message: {
                         name: '',
                         lastName: '',
                         pass: '',
                         frmNumber: '',
                         frmDate: '',
                         frmEmail: '',
                         frmCheck: '',
                         frmRadio: '',
                         frmRange: '',
                         frmSwitch: '',
                         frmSelect: '',
                         serverResponse: ''
                    }
               },
               methods: {
                    validateData(e) {
                         let input = e.target;
                         console.log(!input.value)
                         let expression = '';
                         console.log(input);
                         if (input.pattern) {
                              let regex = new RegExp(input.pattern);
                              expression = !regex.exec(input.value);
                              console.log(expression);
                         } else {
                              expression = !input.value
                         }

                         if (expression) {
                              this.message[input.name] = `Dato Incorrecto, ${input.title}`
                         } else {
                              this.message[input.name] = ''
                         }
                    },
                    validatePass(e) {
                         let pass = e.target;
                         if (pass.value.length < 8) {
                              this.message[pass.name] = 'La contraseña debe tener minimo 8 caracteres';
                         } else {
                              this.message[pass.name] = '';
                         }
                    },
                    sendFrm() {

                         console.log('enviando frm');
                         let miFrm = document.getElementById('frmApp');
                         formData = new FormData(miFrm);
                         axios.post('./server.php', formData)
                              .then(respuesta => {
                                   console.log(respuesta);
                                   this.message.serverResponse = respuesta.data;
                                   M.toast({
                                        html: 'El Mensaje se envio Correctamente'
                                   })
                              })
                    }
               }
          })
     </script>
</body>

</html>